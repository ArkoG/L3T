namespace = REC

# Artist startup
character_event ={
    id = REC.2100
	hide_window = yes

	is_triggered_only = yes	
	
	only_playable = yes
	
	immediate = {
		if = {
			limit = { # The Pope to ensure that it is executed only once
				religion = catholic
				controls_religion = yes
			}
			# Create apprentis
			set_variable = { which = apprenti_startup value = 4 } # 1/3 of the startuplimit
			while = {
				limit = { check_variable = { which = apprenti_startup value = 1 } }
				subtract_variable = { which = apprenti_startup value = 1 }
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = apprenti_sculpteur
					age = 12
					dynasty = none
					female = no
				}
				new_character = {
					give_nickname = nick_le_sculpteur
					join_society = artist_guild
					move_character = THIS # Remove character of play court
				}
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = apprenti_verrier
					age = 12
					dynasty = none
					female = no
				}
				new_character = {
					give_nickname = nick_le_verrier
					join_society = artist_guild
					move_character = THIS # Remove character of play court
				}
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = apprenti_fresquiste
					age = 12
					dynasty = none
					female = no
				}
				new_character = {
					give_nickname = nick_le_fresquiste
					join_society = artist_guild
					move_character = THIS # Remove character of play court
				}
			}
			
			# Create compagnons
			set_variable = { which = compagnon_startup value = 3 } # 1/3 of the startuplimit
			while = {
				limit = { check_variable = { which = compagnon_startup value = 1 } }
				subtract_variable = { which = compagnon_startup value = 1 }
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = compagnon_sculpteur
					age = 30
					dynasty = none
					female = no
				}
				new_character = {
					give_nickname = nick_le_sculpteur
					join_society = artist_guild
					society_rank_up = 1
					move_character = THIS # Remove character of play court
				}
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = compagnon_verrier
					age = 30
					dynasty = none
					female = no
				}
				new_character = {
					give_nickname = nick_le_verrier
					join_society = artist_guild
					society_rank_up = 1
					move_character = THIS # Remove character of play court
				}
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = compagnon_fresquiste
					age = 30
					dynasty = none
					female = no
				}
				new_character = {
					give_nickname = nick_le_fresquiste
					join_society = artist_guild
					society_rank_up = 1
					move_character = THIS # Remove character of play court
				}
			}
			
			# Create maitres
			set_variable = { which = maitre_startup value = 2 } # 1/3 of the startuplimit
			while = {
				limit = { check_variable = { which = maitre_startup value = 1 } }
				subtract_variable = { which = maitre_startup value = 1 }
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = maitre_sculpteur
					age = 50
					dynasty = none
					female = no
				}
				new_character = {
					give_nickname = nick_le_sculpteur
					join_society = artist_guild
					society_rank_up = 2
					move_character = THIS # Remove character of play court
				}
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = maitre_verrier
					age = 50
					dynasty = none
					female = no
				}
				new_character = {
					give_nickname = nick_le_verrier
					join_society = artist_guild
					society_rank_up = 2
					move_character = THIS # Remove character of play court
				}
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = maitre_fresquiste
					age = 50
					dynasty = none
					female = no
				}
				new_character = {
					give_nickname = nick_le_fresquiste
					join_society = artist_guild
					society_rank_up = 2
					move_character = THIS # Remove character of play court
				}
			}
			
			# Remove non-artists of the guild
			any_society_member = {
				limit = {
					society_member_of = artist_guild
					NOT = {
						trait = apprenti_sculpteur
						trait = compagnon_sculpteur
						trait = maitre_sculpteur
						trait = apprenti_fresquiste
						trait = compagnon_fresquiste
						trait = maitre_fresquiste
						trait = apprenti_verrier
						trait = compagnon_verrier
						trait = maitre_verrier
					}
				}
				leave_society = yes
			}
		}
	}
}

# Apprenti creation by decade
character_event ={
    id = REC.2101
	hide_window = yes

	is_triggered_only = yes	
	
	only_playable = yes
	ai = no
	
	immediate = {
		if = {
			limit = {  # Should be executed once
				religion = catholic
				controls_religion = yes
			}
			
			# Create apprentis
			if = {
				limit = {
					is_society_rank_full = {
						society = artist_guild
						rank = 1
					}
				}
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = apprenti_sculpteur
					age = 18
					dynasty = none
					female = no
				}
				new_character = {
					join_society = artist_guild
					move_character = THIS # Remove character of play court
				}
			}
			if = {
				limit = {
					is_society_rank_full = {
						society = artist_guild
						rank = 1
					}
				}
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = apprenti_verrier
					age = 18
					dynasty = none
					female = no
				}
				new_character = {
					join_society = artist_guild
					move_character = THIS # Remove character of play court
				}
			}
			if = {
				limit = {
					is_society_rank_full = {
						society = artist_guild
						rank = 1
					}
				}
				create_character = {
					religion = catholic
					culture = random
					random_traits = yes
					trait = apprenti_fresquiste
					age = 18
					dynasty = none
					female = no
				}
				new_character = {
					join_society = artist_guild
					move_character = THIS # Remove character of play court
				}
			}
		}
	}
}

# Stained glass theme
character_event ={
    id = REC.2102
	desc = "DESCREC.2102"
	picture = GFX_evt_REC8

	is_triggered_only = yes
	
	trigger = {
		trait = batisseur_cathedrale
		
		any_demesne_province = {
			has_province_modifier = chantier_cathedrale
			NOT = { has_province_modifier = chantier_stop }
		}
		
		any_courtier = {
			trait = maitre_verrier
			has_character_modifier = work_on_cathedral 
		}
	}
	
	option = {
		name = "REC.2102A"
		piety = 25
		wealth = -10
		character_event = { id = REC.2103 }
	}
	
	option = {
		name = "REC.2102B"
		prestige = 15
		wealth = -10
		character_event = { id = REC.2103 }
	}
	
	option = {
		name = "REC.2102C"
	}
}

# Stained glass size	
character_event ={
    id = REC.2103
	desc = "DESCREC.2103"
	picture = GFX_evt_REC8

	is_triggered_only = yes
	
	option = {
		name = "REC.2103A"
	}
	
	option = {
		name = "REC.2103B"
		trigger = { available_apprentice_glass_maker = yes }
		wealth = -10
		custom_tooltip = { 
			text = TOOLTIPREC.2103B
			hire_apprentice_glass_maker = yes
		}
	}
	
	option = {
		name = "REC.2103C"
		trigger = { available_compagnon_glass_maker = yes }
		wealth = -25
		prestige = 5
		custom_tooltip = { 
			text = TOOLTIPREC.2103C
			hire_compagnon_glass_maker = yes
		}
	}
	
	option = {
		name = "REC.2103D"
		trigger = {
			available_apprentice_glass_maker = yes
			available_compagnon_glass_maker = yes
		}
		wealth = -35
		prestige = 10
		custom_tooltip = { 
			text = TOOLTIPREC.2103D
			hire_apprentice_glass_maker = yes
			hire_compagnon_glass_maker = yes
		}
	}
}

# Death of a master glass maker
# ROOT is the dead master glass maker
character_event ={
    id = REC.2104
	hide_window = yes

	is_triggered_only = yes	
	
	trigger = {
		trait = maitre_verrier
		has_character_modifier = work_on_cathedral 
	}
	
	immediate = {
		employer = {
			if = {
				limit = {
					any_courtier = {
						trait = maitre_verrier
						has_character_modifier = work_on_cathedral 
						NOT = { character = ROOT }
					}
				}
				character_event = { id = REC.2106 }
				break = yes
			}
			character_event = { id = REC.2105 }
		}
	}	
}

# Employer has no more master glass maker
character_event ={	
	id = REC.2105 
	desc = "DESCREC.2105"
	picture = GFX_evt_REC5

	is_triggered_only = yes
	
	option = {
		name = "REC.2105A"
		trigger = {
			any_courtier = {
				trait = compagnon_verrier
				has_character_modifier = work_on_cathedral 
			}
		}
		wealth = -30
		prestige = 10
		random_courtier = {
			limit = {
				trait = compagnon_verrier
				has_character_modifier = work_on_cathedral 
			}
			remove_trait = compagnon_verrier
			add_trait = maitre_verrier
			hidden_tooltip = { change_society_currency = -1250 }
		}
	}
	
	option = {
		name = "REC.2105B"
		trigger = { available_master_glass_maker = yes }
		hire_master_glass_maker = yes
	}
	
	option = {
		name = "REC.2105C"
		custom_tooltip = { text = TOOLTIPREC.2105C }
	}
}
	
	
# Employer has still master glass maker
character_event ={	
	id = REC.2106
	desc = "DESCREC.2106"
	picture = GFX_evt_REC5

	is_triggered_only = yes
	
	option = {
		name = "REC.2106A"
	}
	
	option = {
		name = "REC.2106B"
		trigger = { available_master_glass_maker = yes }
		hire_master_glass_maker = yes
	}
	
	option = {
		name = "REC.2106C"
		trigger = { available_compagnon_glass_maker = yes }
		hire_compagnon_glass_maker = yes
	}
}
	