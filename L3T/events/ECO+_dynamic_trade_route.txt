namespace = TRADE

# Give the step B of the trade routes
province_event = {
    id = TRADE.0001
	hide_window = yes
	
	trigger = {
		# Give the bloc B to a province which is neighbor to a province with the previous bloc, here A
		any_neighbor_province = {
			has_province_flag = bloc_A
		}
		
		NOT = {
			# To not give step B to the province which has already a bloc (typically the previous step, here A)
			has_province_modifier = route_terrestre
			has_province_modifier = route_fluviale
			
			# To not give step B to distinct routes each other
			any_neighbor_province = { has_province_flag = bloc_B }
			
			# To not give step B to a province which don't have a minimal distance of 1 (in terms of neighboor) to a step A province
			any_neighbor_province = { has_province_flag = bloc_C }
			any_neighbor_province = { has_province_flag = bloc_D }
			any_neighbor_province = { has_province_flag = bloc_E }
		}
	}
		
	mean_time_to_happen = {
		months = 100
		modifier = {
			factor = 0.01
			any_province_holding = {
				count = 2
				tier = baron
				holding_type = city
			}
		}
		modifier = {
			factor = 0.2
			any_province_holding = {
				OR = {
					has_building = CA_route_L1
					has_building = CT_route_L1
					has_building = TP_route_L1
				}
			}
		}
		modifier = {
			factor = 0.5
			has_province_modifier = province_fleuve
		}
		modifier = {
			factor = 0.5
			is_variable_equal = { which = "resourceNb" value = 1 }
		}
	}

	immediate = {
		set_province_flag = bloc_B
		add_province_modifier = { name = flag_B duration = -1 } #TODO mouchard
	}
}

# Give the step C of the trade routes
# COPY-PASTE with adaptation of TRADE.0001
province_event = {
    id = TRADE.0002
	hide_window = yes
	
	trigger = {
		any_neighbor_province = {
			has_province_flag = bloc_B
			OR = {
				has_province_modifier = route_terrestre
				has_province_modifier = route_fluviale
			}
		}
		
		NOT = {
			has_province_modifier = route_terrestre
			has_province_modifier = route_fluviale
			any_neighbor_province = { has_province_flag = bloc_A }
			any_neighbor_province = { has_province_flag = bloc_C }
			any_neighbor_province = { has_province_flag = bloc_D }
			any_neighbor_province = { has_province_flag = bloc_E }
		}
	}
		
	mean_time_to_happen = {
		months = 100
		modifier = {
			factor = 0.01
			any_province_holding = {
				count = 2
				tier = baron
				holding_type = city
			}
		}
		modifier = {
			factor = 0.2
			any_province_holding = {
				OR = {
					has_building = CA_route_L1
					has_building = CT_route_L1
					has_building = TP_route_L1
				}
			}
		}
		modifier = {
			factor = 0.5
			has_province_modifier = province_fleuve
		}
		modifier = {
			factor = 0.5
			is_variable_equal = { which = "resourceNb" value = 1 }
		}
	}

	immediate = {
		set_province_flag = bloc_C
		add_province_modifier = { name = flag_C duration = -1 } #TODO mouchard
	}
}

# Give the step D of the trade routes
# COPY-PASTE with adaptation of TRADE.0001
province_event = {
    id = TRADE.0003
	hide_window = yes
	
	trigger = {
		any_neighbor_province = {
			has_province_flag = bloc_C
			OR = {
				has_province_modifier = route_terrestre
				has_province_modifier = route_fluviale
			}
		}
		
		NOT = {
			has_province_modifier = route_terrestre
			has_province_modifier = route_fluviale
			any_neighbor_province = { has_province_flag = bloc_A }
			any_neighbor_province = { has_province_flag = bloc_B }
			any_neighbor_province = { has_province_flag = bloc_D }
			any_neighbor_province = { has_province_flag = bloc_E }
		}
	}
		
	mean_time_to_happen = {
		months = 100
		modifier = {
			factor = 0.01
			any_province_holding = {
				count = 2
				tier = baron
				holding_type = city
			}
		}
		modifier = {
			factor = 0.2
			any_province_holding = {
				OR = {
					has_building = CA_route_L1
					has_building = CT_route_L1
					has_building = TP_route_L1
				}
			}
		}
		modifier = {
			factor = 0.5
			has_province_modifier = province_fleuve
		}
		modifier = {
			factor = 0.5
			is_variable_equal = { which = "resourceNb" value = 1 }
		}		
	}

	immediate = {
		set_province_flag = bloc_D
		add_province_modifier = { name = flag_D duration = -1 } #TODO mouchard
	}
}

# Give the step E of the trade routes
# COPY-PASTE with adaptation of TRADE.0001
province_event = {
    id = TRADE.0004
	hide_window = yes
	
	trigger = {
		any_neighbor_province = {
			has_province_flag = bloc_D
			OR = {
				has_province_modifier = route_terrestre
				has_province_modifier = route_fluviale
			}
		}
		
		NOT = {
			has_province_modifier = route_terrestre
			has_province_modifier = route_fluviale
			any_neighbor_province = { has_province_flag = bloc_A }
			any_neighbor_province = { has_province_flag = bloc_B }
			any_neighbor_province = { has_province_flag = bloc_C }
			any_neighbor_province = { has_province_flag = bloc_E }
		}
	}
		
	mean_time_to_happen = {
		months = 100
		modifier = {
			factor = 0.01
			any_province_holding = {
				count = 2
				tier = baron
				holding_type = city
			}
		}
		modifier = {
			factor = 0.2
			any_province_holding = {
				OR = {
					has_building = CA_route_L1
					has_building = CT_route_L1
					has_building = TP_route_L1
				}
			}
		}
		modifier = {
			factor = 0.5
			has_province_modifier = province_fleuve
		}
		modifier = {
			factor = 0.5
			is_variable_equal = { which = "resourceNb" value = 1 }
		}
	}

	immediate = {
		set_province_flag = bloc_E		
		add_province_modifier = { name = flag_E duration = -1 } #TODO mouchard
	}
}

# Give the route modifier
province_event = {
    id = TRADE.0005
	hide_window = yes
	
	trigger = {
		OR = {
			has_province_flag = bloc_B
			has_province_flag = bloc_C
			has_province_flag = bloc_D
			has_province_flag = bloc_E
		}
		any_province_holding = {
			OR = {
				has_building = CA_route_L1
				has_building = CT_route_L1
				has_building = TP_route_L1
				has_building = CA_fleuve_L1
				has_building = CT_fleuve_L1
				has_building = TP_fleuve_L1
			}
		}
		NOT = {
			has_province_modifier = route_fluviale
			has_province_modifier = route_terrestre
		}
	}
	
	mean_time_to_happen = {
		months = 10
	}
	
	immediate = {
		if = {
			limit = { has_province_modifier = province_fleuve }
			add_province_modifier = { name = route_fluviale duration = -1 }
		}
		if = {
			limit = { NOT = { has_province_modifier = province_fleuve } }
			add_province_modifier = { name = route_terrestre duration = -1 }
		}
	}
}

# Give the commercial node modifier
province_event = {
    id = TRADE.0006
	hide_window = yes
	
	trigger = {
		OR = {
			has_province_flag = bloc_C
			has_province_flag = bloc_D
			has_province_flag = bloc_E
		}
		any_neighbor_province = {
			count = 3
			OR = {
				has_province_modifier = route_fluviale
				has_province_modifier = route_terrestre
			}
		}
	}
	
	mean_time_to_happen = {
		months = 10
	}
	
	immediate = {
		add_province_modifier = { name = 3connexion_commerciale duration = -1 }
	}
}
