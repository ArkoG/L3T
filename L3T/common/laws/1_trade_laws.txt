# Demesne type (de facto) laws (set for the PRIMARY title in a demesne but affects the whole demesne)

law_groups = {
	law_group_trade_octroi = {
		law_type = realm
	}
}

laws = {
	### CITY OCTROI

	law_trade_octroi_0 = {
		group = law_group_trade_octroi
		default = yes

		potential = {
			holder_scope = {
				NOT = {
					is_nomadic = yes
					is_tribal = yes
				}
			}
		}

		allow = {
			OR = {
				holder_scope = { is_republic = yes }
				holder_scope = { 
					is_feudal = yes
					any_demesne_title = { holding_type = city }
				}
			}
		}

		revoke_allowed = { always = no }			
		ai_will_do = { factor = 0.005 } #test totoro adds some subtility here
		ai_will_revoke = { factor = 0 }
		
		effect = {
			hidden_tooltip = {
				revoke_law = law_trade_octroi_1
			}
			custom_tooltip = { text = TOOLTIP_octroi_exemption_consequences }
		}
		pass_effect = {
			holder_scope = {
				any_demesne_title = {
					limit = { holding_type = city }
					remove_holding_modifier = octroi_holding
					clr_title_flag = octroi_law_duration
					location = { remove_province_modifier = octroi_province }
				}
			}
		}
	}
	law_trade_octroi_1 = {
		group = law_group_trade_octroi
		
		potential = {
			holder_scope = {
				NOT = {
					is_nomadic = yes
					is_tribal = yes
				}
			}
		}

		allow = {
			OR = {
				holder_scope = { is_republic = yes }
				holder_scope = { 
					is_feudal = yes
					any_demesne_title = { holding_type = city }
				}
			}
			holder_scope = { wealth = 50 }
		}

		revoke_allowed = { always = no }			
		ai_will_do = { factor = 0.01 } #test totoro adds some subtility here
		ai_will_revoke = { factor = 0 }
		
		effect = {
			hidden_tooltip = {
				revoke_law = law_trade_octroi_0
			}
			custom_tooltip = { text = TOOLTIP_octroi_enacting_consequences }
		}
		pass_effect = {
			holder_scope = {
				wealth = -50
			}
			holder_scope = {
				any_demesne_title = {
					limit = {  holding_type = city }
					add_holding_modifier = { modifier = octroi_holding duration = -1 }
					set_title_flag = octroi_law_duration
					location = { add_province_modifier = { modifier = octroi_province duration = -1 }}
				}
			}
		}
	}
}